# Crypto Tracker

Приложение для отслеживания и прогнозирования курсов криптовалют с настраиваемыми дашбордами и расширенной аналитикой.

## Основные функции

- **Мониторинг цен** криптовалют в реальном времени
- **Настраиваемые дашборды** с уникальными идентификаторами (UUID)
- **Прогнозирование** цен с выбором периода и модели (ARIMA/LSTM)
- **Визуализация** исторических данных и прогнозов
- **Персональный список отслеживания** криптовалют
- **Страница детального анализа** для каждой криптовалюты

## Стек технологий

- Фронтенд: Next.js, React, WebSocket, Chart.js, Redux
- Бэкенд: FastAPI (Python), MongoDB, Redis
- Внешние API: CoinGecko
- Модели прогнозирования: ARIMA, LSTM
- Дополнительно: UUID для идентификации дашбордов, системы кэширования

## Требования

- Docker
- Docker Compose
- Node.js 18+
- Python 3.9+
- MongoDB
- Redis

## Установка и запуск

### Запуск с помощью Docker

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd crypto-tracker
```

2. Создайте файл `.env` на основе `.env.example` и настройте переменные окружения:
```bash
cp .env.example .env
# Отредактируйте .env файл с вашими настройками
```

3. Запустите проект с помощью Docker Compose:
```bash
docker-compose up --build
```

4. Откройте приложение в браузере:
```
http://localhost:3000
```

### Ручной запуск (для разработки)

1. Настройте и запустите MongoDB и Redis

2. Запустите backend сервисы:
```bash
cd backend/user_service
pip install -r requirements.txt
uvicorn main:app --reload --port 8000

cd backend/prediction_service
pip install -r requirements.txt
uvicorn main:app --reload --port 8001
```

3. Запустите frontend:
```bash
cd frontend
npm install
npm run dev
```

## Структура проекта

```
.
├── frontend/                     # Next.js приложение
│   ├── components/               # React компоненты
│   ├── pages/                    # Страницы приложения
│   ├── services/                 # API сервисы
│   └── store/                    # Redux store
├── backend/
│   ├── user_service/             # Сервис пользователей и дашбордов
│   │   ├── models/               # Модели данных
│   │   ├── routers/              # API эндпоинты
│   │   └── services/             # Бизнес-логика
│   └── prediction_service/       # Сервис предсказаний
│       ├── data/                 # Работа с данными
│       ├── models/               # Модели машинного обучения
│       └── routers/              # API эндпоинты
├── docker-compose.yml            # Конфигурация Docker
└── README.md                     # Документация
```

## Система дашбордов

В приложении реализована система настраиваемых дашбордов:

- **Уникальные идентификаторы (UUID)**: каждый дашборд имеет постоянный идентификатор, который сохраняется при переименовании
- **Настраиваемые виджеты**: графики цен, прогнозы, таблицы данных
- **Персонализация**: выбор криптовалют, периодов отображения, типов графиков
- **Сохранение настроек**: автоматическое сохранение всех настроек виджетов

### Работа с дашбордами

1. Создание нового дашборда: нажмите кнопку "+" на странице дашбордов
2. Добавление виджетов: нажмите "Добавить виджет" на дашборде
3. Настройка виджета: выберите криптовалюту, период и тип графика
4. Переименование дашборда: нажмите на иконку редактирования рядом с названием
5. Удаление виджетов: нажмите на иконку корзины в углу виджета

## API Endpoints

### User Service (http://localhost:8000)

- POST /register - Регистрация пользователя
- POST /token - Получение JWT токена
- GET /user/me - Получение информации о текущем пользователе
- GET /dashboards - Получение списка дашбордов пользователя
- POST /dashboards - Создание нового дашборда
- PUT /dashboards/{uuid} - Обновление дашборда по UUID
- DELETE /dashboards/{uuid} - Удаление дашборда
- GET /watchlist - Получение списка отслеживаемых криптовалют
- PUT /watchlist - Обновление списка отслеживаемых криптовалют

### Prediction Service (http://localhost:8001)

- GET /api/price/{currency} - Получение текущего курса
- GET /api/historical/{currency}/{period} - Получение исторических данных
- GET /api/predict/{currency}/{interval} - Получение прогноза на определенный период
- GET /api/predict/{currency}?model=arima&days=30 - Прогноз с выбором модели и количества дней
- GET /api/predict/by-dates - Прогноз для пользовательского диапазона дат
- WebSocket /ws/updates - Обновления курсов в реальном времени

## Модели прогнозирования

Приложение поддерживает две модели прогнозирования:

### ARIMA (AutoRegressive Integrated Moving Average)

Статистическая модель для анализа и прогнозирования временных рядов.

**Преимущества:**
- Точные краткосрочные прогнозы
- Меньше требований к объему данных
- Быстрое обучение
- Хорошая работа с сезонными паттернами

**Применение:**
- Краткосрочные прогнозы (7-30 дней)
- Стабильные криптовалюты с предсказуемой динамикой

**Особенности реализации:**
- Автоматический подбор параметров (p,d,q) в зависимости от длительности прогноза
- Добавление трендов и циклов для долгосрочных прогнозов (>30 дней)
- Оптимизация для различных периодов (краткосрочный, среднесрочный, долгосрочный)

### LSTM (Long Short-Term Memory)

Нейронная сеть с архитектурой, специально созданной для обработки последовательностей и временных рядов.

**Преимущества:**
- Выявление сложных нелинейных зависимостей
- Учет долгосрочных трендов
- Адаптация к резким изменениям в данных
- Более точные долгосрочные прогнозы

**Применение:**
- Долгосрочные прогнозы (30+ дней)
- Волатильные криптовалюты с нелинейной динамикой

**Особенности реализации:**
- Автоматический выбор типа тренда для долгосрочных прогнозов
- Разные режимы прогнозирования (восходящий тренд, нисходящий, смешанный, циклический)
- Усиление случайности и шума с увеличением периода прогнозирования

## Как выбрать модель

По умолчанию используется модель ARIMA, как более экономичная и быстрая. Для использования LSTM можно:

1. При вызове API указать параметр `model=lstm`:
```
GET /api/predict/bitcoin?model=lstm&days=30
```

2. В разработке: выбор модели через UI в настройках прогноза.

## Система кэширования

Для оптимизации производительности реализована многоуровневая система кэширования:

- **На фронтенде**: кэширование результатов запросов с проверкой актуальности данных
- **На бэкенде**: Redis для кэширования данных и результатов прогнозов
- **Настраиваемое время жизни кэша** для разных типов данных:
  - Текущие цены: 1 минута
  - Исторические данные: 6 часов
  - Прогнозы: 30 минут

## Особенности реализации прогнозов

Для разных временных периодов применяются различные подходы:

1. **Краткосрочные прогнозы (1-7 дней)**:
   - ARIMA с параметрами (2,1,2)
   - Минимальное сглаживание для быстрой реакции на изменения
   
2. **Среднесрочные прогнозы (8-30 дней)**:
   - ARIMA с параметрами (3,1,2)
   - Большее сглаживание для устранения шума
   
3. **Долгосрочные прогнозы (31-90 дней)**:
   - ARIMA с параметрами (4,1,3) или LSTM
   - Добавление циклических паттернов
   
4. **Сверхдолгосрочные прогнозы (91+ дней)**:
   - ARIMA с параметрами (5,1,4) или LSTM
   - Усиленное сглаживание и добавление трендов

## Разработка

### Фронтенд

```bash
cd frontend
npm install
npm run dev
```

### Бэкенд

```bash
cd backend/user_service
pip install -r requirements.txt
uvicorn main:app --reload

cd backend/prediction_service
pip install -r requirements.txt
uvicorn main:app --reload
```

## Тестирование

```bash
# Фронтенд
cd frontend
npm test

# Бэкенд
cd backend/user_service
python -m pytest

cd backend/prediction_service
python -m pytest
```

## Лицензия

MIT 